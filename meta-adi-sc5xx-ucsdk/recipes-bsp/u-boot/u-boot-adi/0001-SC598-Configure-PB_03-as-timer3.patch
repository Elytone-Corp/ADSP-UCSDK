From ba990e8c4ba1c55f9915b892d6e7325c6f955249 Mon Sep 17 00:00:00 2001
From: Harvin Almeida <harvin.almeida@analog.com>
Date: Fri, 26 Aug 2022 14:09:02 +0000
Subject: [PATCH] SC598 Configure PB_03 as timer3

---
 arch/arm/cpu/armv8/sc59x-64/init.c | 14 ++++++++++++++
 1 file changed, 14 insertions(+)
 mode change 100644 => 100755 arch/arm/cpu/armv8/sc59x-64/init.c

diff --git a/arch/arm/cpu/armv8/sc59x-64/init.c b/arch/arm/cpu/armv8/sc59x-64/init.c
old mode 100644
new mode 100755
index d5bd232a74..ba7d1deccf
--- a/arch/arm/cpu/armv8/sc59x-64/init.c
+++ b/arch/arm/cpu/armv8/sc59x-64/init.c
@@ -332,5 +332,19 @@ void initcode_shared(void)
     *(uint32_t*)(0x3100411C) = 0xE;
     *(uint32_t*)(0x3100410C) = 0xE;
 
+
+#if 1    //set PB_03 as TIMER0_TMR3
+    uint32_t data;
+    //PORTB_MUX, bit7:6=00, *(uint32_t*)(0x310040B0) &= 0xFF3F;
+    data = readl(REG_PORTB_MUX);
+    data &= 0xFF3F; 
+    data |= 0x0000; 
+    writel(data, REG_PORTB_MUX);
+    //PORTB_FER_SET, bit3=1, *(uint32_t*)(0x31004084) |= 0x08;
+    data = readl(REG_PORTB_FER);
+    data |= 0x08;
+    writel(data, REG_PORTB_FER);
+#endif
+
 }
 
-- 
2.17.1

